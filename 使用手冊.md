# 使用手冊 - 113 工科賽電腦修護第二站 PC 端程式

## 目錄
1. [快速開始](#快速開始)
2. [詳細操作說明](#詳細操作說明)
3. [常見問題](#常見問題)
4. [故障排除](#故障排除)

---

## 快速開始

### 步驟 1：硬體準備
1. 確認 Arduino 已上傳對應程式
2. 確認 WS2812 LED 燈條已正確連接
3. 開啟藍牙模組電源或連接 USB 線

### 步驟 2：建立連線
1. 啟動 PC 端程式
2. 從下拉選單選擇正確的 COM Port
3. 點擊「Open」按鈕
4. 確認狀態顯示「Connected」（綠色）

### 步驟 3：開始監控
1. 點擊「Start」按鈕（CPU Loading Monitor 區）
2. 觀察 CPU 使用率數值與顏色變化
3. 觀察 8 顆 LED 燈號同步變色
4. 可選：啟動 RAM Loading 監控

### 步驟 4：測試 EEPROM
1. 在輸入框輸入 4 位元二進位（例如：0101）
2. 點擊「Write」按鈕
3. 確認成功訊息彈出

---

## 詳細操作說明

### 一、程式介面說明

#### 1. 連線設定區（左上）
- **COM Port 下拉選單**：顯示所有可用序列埠
- **藍牙模組名稱**：顯示 ODD-01-0001（根據崗位號碼計算）
- **Open 按鈕**：開啟選定的 COM Port
- **Close 按鈕**：關閉當前連線
- **Refresh 按鈕**：手動刷新 COM Port 列表
- **Connection Status**：顯示連線狀態
  - ?? Connected：已連線
  - ?? Disconnect：未連線

#### 2. CPU Loading Monitor 區
- **CPU Loading 數值**：顯示即時 CPU 使用率（百分比）
- **Color 指示器**：顯示當前對應顏色
  - 綠色：0~50%
  - 黃色：51~84%
  - 紅色：?85%
- **Start 按鈕**：開始監控
- **Stop 按鈕**：停止監控

#### 3. RAM Loading Monitor 區
- **RAM Loading 數值**：顯示即時記憶體使用率
- **Start 按鈕**：開始監控
- **Stop 按鈕**：停止監控

#### 4. EEPROM Write 區
- **Binary Input 輸入框**：輸入 4 位元二進位數值
- **Write 按鈕**：傳送資料至 Arduino EEPROM

#### 5. WS2812 LED Status 區（右上）
- **8 顆圓形燈號**：即時同步 Arduino 端 LED 狀態
- 直徑：22 像素（約 5mm）
- 支援 RGB 全彩顯示

---

### 二、操作流程

#### 藍牙連線流程
```
1. Windows 設定 → 裝置 → 藍牙
2. 配對 HC-05 模組（PIN：1234）
3. 記下配對成功後的 COM Port 編號（例如：COM5）
4. 在程式中選擇該 COM Port
5. 點擊 Open
```

#### USB 連線流程
```
1. 連接 Arduino USB 線
2. 等待驅動程式安裝完成
3. 在程式中選擇對應 COM Port（例如：COM3）
4. 點擊 Open
```

#### CPU 監控操作
```
1. 確認已連線（Connected）
2. 點擊「Start」按鈕
3. 觀察數值每秒更新
4. 觀察顏色指示器變化
5. 觀察 LED 燈號同步變色
6. 需要停止時點擊「Stop」
```

#### EEPROM 寫入操作
```
1. 確認已連線
2. 輸入 4 位元二進位（只能是 0 或 1）
   ? 正確範例：0000, 0101, 1111, 1010
   ? 錯誤範例：123, 10, abc, 01011
3. 點擊「Write」
4. 確認成功訊息
5. 輸入框自動清空
```

---

### 三、資料格式說明

#### 1. 二進位轉換對照表
| 二進位 | 十進位 | 二進位 | 十進位 |
|--------|--------|--------|--------|
| 0000 | 0 | 1000 | 8 |
| 0001 | 1 | 1001 | 9 |
| 0010 | 2 | 1010 | 10 |
| 0011 | 3 | 1011 | 11 |
| 0100 | 4 | 1100 | 12 |
| 0101 | 5 | 1101 | 13 |
| 0110 | 6 | 1110 | 14 |
| 0111 | 7 | 1111 | 15 |

#### 2. 通訊封包格式

**CPU Loading 封包**
```
位元組 | 內容 | 說明
-------|------|------
0      | 0xAA | 起始字元
1      | 0x10 | 命令碼（CPU Loading）
2      | 0x04 | 資料長度
3      | XX   | CPU 使用率（0-100）
4      | RR   | 紅色分量（0-255）
5      | GG   | 綠色分量（0-255）
6      | BB   | 藍色分量（0-255）
7      | CHK  | 校驗碼
8      | 0x55 | 結束字元
```

**EEPROM 寫入封包**
```
位元組 | 內容 | 說明
-------|------|------
0      | 0xAA | 起始字元
1      | 0x20 | 命令碼（EEPROM）
2      | 0x01 | 資料長度
3      | XX   | 資料值（0-15）
4      | CHK  | 校驗碼
5      | 0x55 | 結束字元
```

---

## 常見問題

### Q1: 找不到 COM Port？
**A:** 
1. 檢查藍牙是否已配對
2. 檢查 USB 線是否已連接
3. 點擊「Refresh」按鈕手動更新
4. 重新啟動程式

### Q2: 無法開啟 COM Port？
**A:**
1. 確認沒有其他程式占用該埠（例如：Arduino IDE 的序列埠監視器）
2. 拔除並重新插入 USB 線
3. 重新配對藍牙裝置
4. 重新啟動電腦

### Q3: 顯示「Not BIN Format」？
**A:**
1. 確認只輸入 0 和 1
2. 確認恰好輸入 4 個字元
3. 範例：0101 ?、101 ?、1234 ?

### Q4: LED 燈號不同步？
**A:**
1. 檢查 Arduino 端程式是否正確上傳
2. 檢查序列埠連線是否穩定
3. 檢查 WS2812 接線是否正確
4. 重新連線 COM Port

### Q5: CPU 使用率顯示 0%？
**A:**
1. 等待 1-2 秒（首次讀取需要初始化）
2. 檢查是否已點擊「Start」按鈕
3. 重新啟動程式

### Q6: 連線後立刻斷開？
**A:**
1. 檢查 Arduino 電源是否穩定
2. 檢查藍牙模組電源
3. 確認 Baud Rate 設定為 9600
4. 檢查 Arduino 端程式是否正常運作

---

## 故障排除

### 症狀：程式無法啟動
**可能原因**：
- 缺少 .NET 8.0 執行環境
- 系統權限不足

**解決方法**：
1. 安裝 .NET 8.0 Desktop Runtime
2. 以系統管理員身分執行程式

---

### 症狀：COM Port 列表為空
**可能原因**：
- 沒有任何序列埠裝置
- 驅動程式未安裝

**解決方法**：
1. 連接 USB 裝置或配對藍牙
2. 安裝對應驅動程式（Arduino 或 藍牙）
3. 到裝置管理員確認 COM Port

---

### 症狀：資料傳送無反應
**可能原因**：
- Arduino 未上傳程式
- 封包格式錯誤
- 接線問題

**解決方法**：
1. 確認 Arduino 端程式已上傳
2. 用序列埠監視器測試 Arduino
3. 檢查 TX/RX 接線

---

### 症狀：WS2812 不亮
**可能原因**：
- 電源供應不足
- 資料線接錯
- LED 損壞

**解決方法**：
1. 確認 5V 電源供應穩定
2. 檢查 Data Pin 接線（預設 Pin 6）
3. 用簡單測試程式確認 LED 功能
4. 檢查 GND 共地

---

## 進階設定

### 修改崗位號碼
在 `Form1.vb` 中修改：
```vb
Private stationNumber As String = "01"  ' 改成您的崗位號碼
```

### 修改 Baud Rate
在 `SerialPortManager.vb` 中修改：
```vb
serialPort.BaudRate = 9600  ' 修改為其他速率
```

### 修改 LED 數量
在 `LedDisplayManager.vb` 中修改陣列大小

### 修改更新頻率
在 `Form1.Designer.vb` 中修改計時器間隔：
```vb
Me.timerCpu.Interval = 1000  ' 單位：毫秒
```

---

## 技術支援

### 開發環境
- Visual Studio 2022
- .NET 8.0 Windows Forms
- VB.NET

### 相依套件
- System.IO.Ports v8.0.0
- System.Management v8.0.0

### 聯絡資訊
- 競賽單位：全國高級中等學校工業類科學生技藝競賽
- 職類：電腦修護
- 站別：第二站

---

## 附錄

### A. 鍵盤快捷鍵
目前版本不支援快捷鍵（可自行擴充）

### B. 日誌記錄
建議自行添加日誌功能以便除錯

### C. 效能優化建議
1. 關閉不需要的監控功能
2. 調整更新頻率
3. 使用 USB 連線而非藍牙（更穩定）

### D. 安全性建議
1. 定期檢查序列埠連線狀態
2. 驗證接收到的資料格式
3. 添加異常處理機制

---

**文件版本**: v1.0  
**最後更新**: 2025-01-XX  
**適用程式版本**: v2.0  
**崗位號碼**: 01
